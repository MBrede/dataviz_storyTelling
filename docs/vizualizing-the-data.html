<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Vizualizing the data | Comparison of Narratives between German and Swedish News Articles during the COVID-19 Pandemic</title>
  <meta name="description" content="Our results for the dataviz-assignment." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Vizualizing the data | Comparison of Narratives between German and Swedish News Articles during the COVID-19 Pandemic" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Our results for the dataviz-assignment." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Vizualizing the data | Comparison of Narratives between German and Swedish News Articles during the COVID-19 Pandemic" />
  
  <meta name="twitter:description" content="Our results for the dataviz-assignment." />
  

<meta name="author" content="Max Brede und Janik Dunker" />


<meta name="date" content="2020-12-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-acquisition.html"/>
<link rel="next" href="references.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.16/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">DataViz-Assignment</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="data-acquisition.html"><a href="data-acquisition.html"><i class="fa fa-check"></i>Data Acquisition</a>
<ul>
<li class="chapter" data-level="" data-path="data-acquisition.html"><a href="data-acquisition.html#sources-for-news-articles"><i class="fa fa-check"></i>Sources for News-Articles</a></li>
<li class="chapter" data-level="" data-path="data-acquisition.html"><a href="data-acquisition.html#data-collection"><i class="fa fa-check"></i>Data Collection</a></li>
<li class="chapter" data-level="" data-path="data-acquisition.html"><a href="data-acquisition.html#combining-the-results"><i class="fa fa-check"></i>Combining the results</a></li>
<li class="chapter" data-level="" data-path="data-acquisition.html"><a href="data-acquisition.html#pre-processing-for-the-text-visualisations"><i class="fa fa-check"></i>Pre-processing for the text visualisations</a></li>
<li class="chapter" data-level="" data-path="data-acquisition.html"><a href="data-acquisition.html#sentiments"><i class="fa fa-check"></i>Sentiments</a></li>
<li class="chapter" data-level="" data-path="data-acquisition.html"><a href="data-acquisition.html#translation"><i class="fa fa-check"></i>Translation</a></li>
<li class="chapter" data-level="" data-path="data-acquisition.html"><a href="data-acquisition.html#merging-and-exporting-the-final-sets"><i class="fa fa-check"></i>Merging and exporting the final sets</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="vizualizing-the-data.html"><a href="vizualizing-the-data.html"><i class="fa fa-check"></i>Vizualizing the data</a>
<ul>
<li class="chapter" data-level="" data-path="vizualizing-the-data.html"><a href="vizualizing-the-data.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="vizualizing-the-data.html"><a href="vizualizing-the-data.html#attaining-the-data"><i class="fa fa-check"></i>Attaining the data</a></li>
<li class="chapter" data-level="" data-path="vizualizing-the-data.html"><a href="vizualizing-the-data.html#viz-2"><i class="fa fa-check"></i>Viz 2</a></li>
<li class="chapter" data-level="" data-path="vizualizing-the-data.html"><a href="vizualizing-the-data.html#der-plot-ist-noch-ein-bisschen-überladen.-was-ich-nicht-so-richtig-verstehe"><i class="fa fa-check"></i>Der Plot ist noch ein bisschen überladen. Was ich nicht so richtig verstehe</a></li>
<li class="chapter" data-level="" data-path="vizualizing-the-data.html"><a href="vizualizing-the-data.html#viz-3"><i class="fa fa-check"></i>Viz 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Lizenzvertrag" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Comparison of Narratives between German and Swedish News Articles during the COVID-19 Pandemic</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="vizualizing-the-data" class="section level1">
<h1>Vizualizing the data</h1>
<div id="introduction-1" class="section level2">
<h2>Introduction</h2>
<p>During the COVID-19 pandemic different policies have been chosen by the countries
to prevent a overloading of their health care system. Especially the country sweden
has been known for choosing moderate policies. So that the question came up how
the press of other countries is reporting about sweden. And in reverse, how
sweden is reporting about other countries. We have choosen as a comparison
Germany since it’s the country we are from.</p>
<p>First off we want to show how the situations of new confirmed cases and the
corresponding policies differ between the two countries.</p>
</div>
<div id="attaining-the-data" class="section level2">
<h2>Attaining the data</h2>
<p>For attaining the covid-19 policy data we read the data from the github of the
<a href="https://www.bsg.ox.ac.uk/research/research-projects/coronavirus-government-response-tracker#data">Coronavirus Government Response Tracker Project</a>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="vizualizing-the-data.html#cb26-1" aria-hidden="true" tabindex="-1"></a>limits<span class="ot">=</span><span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">&#39;2020-01-01&#39;</span>, <span class="st">&#39;2020-12-31&#39;</span>))</span>
<span id="cb26-2"><a href="vizualizing-the-data.html#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="vizualizing-the-data.html#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co"># read policies csv-file</span></span>
<span id="cb26-4"><a href="vizualizing-the-data.html#cb26-4" aria-hidden="true" tabindex="-1"></a>policies <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/OxCGRT/covid-policy-tracker/master/data/OxCGRT_latest.csv&#39;</span>)</span></code></pre></div>
<p>For the meanings of specific policies take a look on the <a href="https://github.com/OxCGRT/covid-policy-tracker/blob/master/documentation/codebook.md">Codebook</a> of the project.</p>
<p>A function for the data pre-filtering:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="vizualizing-the-data.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a function for pre filtering</span></span>
<span id="cb27-2"><a href="vizualizing-the-data.html#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="vizualizing-the-data.html#cb27-3" aria-hidden="true" tabindex="-1"></a>filtering <span class="ot">&lt;-</span> <span class="cf">function</span>(country_name, policy_filter) {</span>
<span id="cb27-4"><a href="vizualizing-the-data.html#cb27-4" aria-hidden="true" tabindex="-1"></a>   policies_ger <span class="ot">&lt;-</span> policies <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="vizualizing-the-data.html#cb27-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">filter</span>(CountryName<span class="sc">==</span>country_name) <span class="sc">%&gt;%</span> <span class="co"># filter policies by germany</span></span>
<span id="cb27-6"><a href="vizualizing-the-data.html#cb27-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">select</span>(policy_filter) <span class="sc">%&gt;%</span> <span class="co"># select policies of interest</span></span>
<span id="cb27-7"><a href="vizualizing-the-data.html#cb27-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mutate</span>(<span class="at">Date=</span><span class="fu">as.Date</span>(<span class="fu">as.character</span>(Date),</span>
<span id="cb27-8"><a href="vizualizing-the-data.html#cb27-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">format =</span> <span class="st">&quot;%Y%m%d&quot;</span>)) <span class="sc">%&gt;%</span> <span class="co"># change date format</span></span>
<span id="cb27-9"><a href="vizualizing-the-data.html#cb27-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="co"># remove rows with na entries</span></span>
<span id="cb27-10"><a href="vizualizing-the-data.html#cb27-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">arrange</span>(Date) <span class="co"># order rows by date</span></span>
<span id="cb27-11"><a href="vizualizing-the-data.html#cb27-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The data has to be restructured for being possible to plot. So that’s the
function for doing that:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="vizualizing-the-data.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a function to build start and stop labels for the equivalent policy</span></span>
<span id="cb28-2"><a href="vizualizing-the-data.html#cb28-2" aria-hidden="true" tabindex="-1"></a>build_start_stop_labels <span class="ot">&lt;-</span> <span class="cf">function</span>(policies, policy, label){</span>
<span id="cb28-3"><a href="vizualizing-the-data.html#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get selected policy data</span></span>
<span id="cb28-4"><a href="vizualizing-the-data.html#cb28-4" aria-hidden="true" tabindex="-1"></a>  selected_policy <span class="ot">&lt;-</span> policies <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="vizualizing-the-data.html#cb28-5" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">select</span>(Date, policy)</span>
<span id="cb28-6"><a href="vizualizing-the-data.html#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="vizualizing-the-data.html#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># build bit-mask for policy changes</span></span>
<span id="cb28-8"><a href="vizualizing-the-data.html#cb28-8" aria-hidden="true" tabindex="-1"></a>  bit_mask <span class="ot">&lt;-</span> selected_policy[,policy] <span class="sc">-</span>  <span class="fu">lag</span>(selected_policy[,policy], <span class="at">n =</span> <span class="dv">1</span>) <span class="sc">!=</span> <span class="dv">0</span></span>
<span id="cb28-9"><a href="vizualizing-the-data.html#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="vizualizing-the-data.html#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># set last entry true (is na because of lag)</span></span>
<span id="cb28-11"><a href="vizualizing-the-data.html#cb28-11" aria-hidden="true" tabindex="-1"></a>  bit_mask[<span class="fu">is.na</span>(bit_mask)] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb28-12"><a href="vizualizing-the-data.html#cb28-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-13"><a href="vizualizing-the-data.html#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># initialize start and stop list</span></span>
<span id="cb28-14"><a href="vizualizing-the-data.html#cb28-14" aria-hidden="true" tabindex="-1"></a>  start <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb28-15"><a href="vizualizing-the-data.html#cb28-15" aria-hidden="true" tabindex="-1"></a>  stop <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb28-16"><a href="vizualizing-the-data.html#cb28-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-17"><a href="vizualizing-the-data.html#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># initialize a state variable for tracking start position</span></span>
<span id="cb28-18"><a href="vizualizing-the-data.html#cb28-18" aria-hidden="true" tabindex="-1"></a>  start_state <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb28-19"><a href="vizualizing-the-data.html#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="vizualizing-the-data.html#cb28-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># iterate through rows for finding start and stop positions</span></span>
<span id="cb28-21"><a href="vizualizing-the-data.html#cb28-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(row <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(bit_mask)){</span>
<span id="cb28-22"><a href="vizualizing-the-data.html#cb28-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># check whether it&#39;s a stop position</span></span>
<span id="cb28-23"><a href="vizualizing-the-data.html#cb28-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(bit_mask[row] <span class="sc">&amp;</span> <span class="sc">!</span>start_state){</span>
<span id="cb28-24"><a href="vizualizing-the-data.html#cb28-24" aria-hidden="true" tabindex="-1"></a>      stop <span class="ot">&lt;-</span> <span class="fu">c</span>(stop, row<span class="dv">-1</span>)</span>
<span id="cb28-25"><a href="vizualizing-the-data.html#cb28-25" aria-hidden="true" tabindex="-1"></a>      start_state <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb28-26"><a href="vizualizing-the-data.html#cb28-26" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb28-27"><a href="vizualizing-the-data.html#cb28-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># check whether it&#39;s a start position</span></span>
<span id="cb28-28"><a href="vizualizing-the-data.html#cb28-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(bit_mask[row] <span class="sc">&amp;</span> start_state){</span>
<span id="cb28-29"><a href="vizualizing-the-data.html#cb28-29" aria-hidden="true" tabindex="-1"></a>      start <span class="ot">&lt;-</span> <span class="fu">c</span>(start, row)</span>
<span id="cb28-30"><a href="vizualizing-the-data.html#cb28-30" aria-hidden="true" tabindex="-1"></a>      start_state <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb28-31"><a href="vizualizing-the-data.html#cb28-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb28-32"><a href="vizualizing-the-data.html#cb28-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-33"><a href="vizualizing-the-data.html#cb28-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-34"><a href="vizualizing-the-data.html#cb28-34" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add last row as stop</span></span>
<span id="cb28-35"><a href="vizualizing-the-data.html#cb28-35" aria-hidden="true" tabindex="-1"></a>  stop <span class="ot">&lt;-</span> <span class="fu">c</span>(stop, row)</span>
<span id="cb28-36"><a href="vizualizing-the-data.html#cb28-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-37"><a href="vizualizing-the-data.html#cb28-37" aria-hidden="true" tabindex="-1"></a>  <span class="co"># retrieve start and stop dates from the data set</span></span>
<span id="cb28-38"><a href="vizualizing-the-data.html#cb28-38" aria-hidden="true" tabindex="-1"></a>  start_date <span class="ot">&lt;-</span> selected_policy[start, <span class="st">&#39;Date&#39;</span>]</span>
<span id="cb28-39"><a href="vizualizing-the-data.html#cb28-39" aria-hidden="true" tabindex="-1"></a>  stop_date <span class="ot">&lt;-</span> selected_policy[stop, <span class="st">&#39;Date&#39;</span>]</span>
<span id="cb28-40"><a href="vizualizing-the-data.html#cb28-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># retrieve event number from the data set</span></span>
<span id="cb28-41"><a href="vizualizing-the-data.html#cb28-41" aria-hidden="true" tabindex="-1"></a>  events <span class="ot">&lt;-</span> selected_policy[start, policy]</span>
<span id="cb28-42"><a href="vizualizing-the-data.html#cb28-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-43"><a href="vizualizing-the-data.html#cb28-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return dataframe with start/stop dates for the polcies</span></span>
<span id="cb28-44"><a href="vizualizing-the-data.html#cb28-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">event =</span> events, <span class="at">start =</span> start_date, <span class="at">end =</span> stop_date,</span>
<span id="cb28-45"><a href="vizualizing-the-data.html#cb28-45" aria-hidden="true" tabindex="-1"></a>                    <span class="at">group =</span> label))</span>
<span id="cb28-46"><a href="vizualizing-the-data.html#cb28-46" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>After that we build the timeline plot for the stay at home.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="vizualizing-the-data.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set filter for columns of interest</span></span>
<span id="cb29-2"><a href="vizualizing-the-data.html#cb29-2" aria-hidden="true" tabindex="-1"></a>policy_filter <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;CountryCode&#39;</span>, <span class="st">&#39;Date&#39;</span>, <span class="st">&#39;C8_International.travel.controls&#39;</span>,</span>
<span id="cb29-3"><a href="vizualizing-the-data.html#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;C6_Stay.at.home.requirements&#39;</span>, <span class="st">&#39;C4_Restrictions.on.gatherings&#39;</span>)</span>
<span id="cb29-4"><a href="vizualizing-the-data.html#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="vizualizing-the-data.html#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># retrieve policy data for germany and sweden</span></span>
<span id="cb29-6"><a href="vizualizing-the-data.html#cb29-6" aria-hidden="true" tabindex="-1"></a>policies_ger <span class="ot">&lt;-</span> <span class="fu">filtering</span>(<span class="st">&#39;Germany&#39;</span>, policy_filter)</span>
<span id="cb29-7"><a href="vizualizing-the-data.html#cb29-7" aria-hidden="true" tabindex="-1"></a>policies_se <span class="ot">&lt;-</span> <span class="fu">filtering</span>(<span class="st">&#39;Sweden&#39;</span>, policy_filter)</span>
<span id="cb29-8"><a href="vizualizing-the-data.html#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="vizualizing-the-data.html#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="co"># rebuild data into start and stop labels</span></span>
<span id="cb29-10"><a href="vizualizing-the-data.html#cb29-10" aria-hidden="true" tabindex="-1"></a>timeline_data <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">build_start_stop_labels</span>(policies_ger,</span>
<span id="cb29-11"><a href="vizualizing-the-data.html#cb29-11" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">&#39;C4_Restrictions.on.gatherings&#39;</span>,</span>
<span id="cb29-12"><a href="vizualizing-the-data.html#cb29-12" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">&#39;Germany&#39;</span>),</span>
<span id="cb29-13"><a href="vizualizing-the-data.html#cb29-13" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">build_start_stop_labels</span>(policies_se,</span>
<span id="cb29-14"><a href="vizualizing-the-data.html#cb29-14" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">&#39;C4_Restrictions.on.gatherings&#39;</span>,</span>
<span id="cb29-15"><a href="vizualizing-the-data.html#cb29-15" aria-hidden="true" tabindex="-1"></a>                                               <span class="st">&#39;Sweden&#39;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="vizualizing-the-data.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># determine range of events</span></span>
<span id="cb30-2"><a href="vizualizing-the-data.html#cb30-2" aria-hidden="true" tabindex="-1"></a>event_range <span class="ot">&lt;-</span> timeline_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(event) <span class="sc">%&gt;%</span> <span class="fu">range</span>()</span>
<span id="cb30-3"><a href="vizualizing-the-data.html#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="vizualizing-the-data.html#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># build color map depending on the range of events</span></span>
<span id="cb30-5"><a href="vizualizing-the-data.html#cb30-5" aria-hidden="true" tabindex="-1"></a>color_map <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">viridis</span>(event_range[<span class="dv">2</span>]<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb30-6"><a href="vizualizing-the-data.html#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="vizualizing-the-data.html#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># add column color and event for specific policy and corresponding policy</span></span>
<span id="cb30-8"><a href="vizualizing-the-data.html#cb30-8" aria-hidden="true" tabindex="-1"></a>timeline_data <span class="sc">%&lt;&gt;%</span> <span class="fu">mutate</span>(<span class="at">color =</span> color_map[<span class="fu">as.integer</span>(event)<span class="sc">+</span><span class="dv">4</span>]) <span class="sc">%&gt;%</span></span>
<span id="cb30-9"><a href="vizualizing-the-data.html#cb30-9" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">mutate</span>(<span class="at">event =</span> <span class="fu">as.character</span>(event))</span>
<span id="cb30-10"><a href="vizualizing-the-data.html#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="vizualizing-the-data.html#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co"># build time line plot for the Restriction of gatherings policy</span></span>
<span id="cb30-12"><a href="vizualizing-the-data.html#cb30-12" aria-hidden="true" tabindex="-1"></a>time_line_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(timeline_data, <span class="fu">aes</span>(<span class="at">x=</span>start, <span class="at">xend=</span>end, <span class="at">y=</span>group, <span class="at">yend=</span>group, <span class="at">color=</span>event)) <span class="sc">+</span></span>
<span id="cb30-13"><a href="vizualizing-the-data.html#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">size=</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb30-14"><a href="vizualizing-the-data.html#cb30-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;no restrictions&#39;</span>, <span class="st">&#39;above 1000 people&#39;</span>,<span class="st">&#39;101-1000 people&#39;</span>, <span class="st">&#39;11-100 people&#39;</span>, <span class="st">&#39;10 people or less&#39;</span>), <span class="at">values =</span> color_map) <span class="sc">+</span></span>
<span id="cb30-15"><a href="vizualizing-the-data.html#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Date&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Country&#39;</span>,</span>
<span id="cb30-16"><a href="vizualizing-the-data.html#cb30-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour=</span><span class="st">&quot;Restrictions on</span><span class="sc">\n</span><span class="st"> gatherings&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-17"><a href="vizualizing-the-data.html#cb30-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">limits =</span> limits)</span></code></pre></div>
<p>After having the policy timeline for germany and sweden the time-series for the
normalized new cases gets added:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="vizualizing-the-data.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># retrieve covid data from covid.ourworldindata.org git repository</span></span>
<span id="cb31-2"><a href="vizualizing-the-data.html#cb31-2" aria-hidden="true" tabindex="-1"></a>covid_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&#39;https://covid.ourworldindata.org/data/owid-covid-data.csv&#39;</span>)</span>
<span id="cb31-3"><a href="vizualizing-the-data.html#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="vizualizing-the-data.html#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># filter for germany and sweden data and select location, date and smoothed new</span></span>
<span id="cb31-5"><a href="vizualizing-the-data.html#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co"># cases per million</span></span>
<span id="cb31-6"><a href="vizualizing-the-data.html#cb31-6" aria-hidden="true" tabindex="-1"></a>covid_data <span class="sc">%&lt;&gt;%</span> <span class="fu">filter</span>(location<span class="sc">==</span><span class="st">&#39;Sweden&#39;</span> <span class="sc">|</span> location<span class="sc">==</span><span class="st">&#39;Germany&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb31-7"><a href="vizualizing-the-data.html#cb31-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">select</span>(location, date,</span>
<span id="cb31-8"><a href="vizualizing-the-data.html#cb31-8" aria-hidden="true" tabindex="-1"></a>                 new_cases_smoothed_per_million) <span class="sc">%&gt;%</span> <span class="co"># select columns of interest</span></span>
<span id="cb31-9"><a href="vizualizing-the-data.html#cb31-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="co"># remove rows with na entries             </span></span>
<span id="cb31-10"><a href="vizualizing-the-data.html#cb31-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">mutate</span>(<span class="at">date=</span><span class="fu">as.Date</span>(<span class="fu">as.character</span>(date),</span>
<span id="cb31-11"><a href="vizualizing-the-data.html#cb31-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">format =</span> <span class="st">&quot;%Y-%m-%d&quot;</span>)) <span class="co"># save date in date format</span></span>
<span id="cb31-12"><a href="vizualizing-the-data.html#cb31-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-13"><a href="vizualizing-the-data.html#cb31-13" aria-hidden="true" tabindex="-1"></a><span class="co"># define colors for time series plot</span></span>
<span id="cb31-14"><a href="vizualizing-the-data.html#cb31-14" aria-hidden="true" tabindex="-1"></a>COLORS <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">Germany =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="at">Sweden =</span><span class="st">&quot;darkred&quot;</span>)</span>
<span id="cb31-15"><a href="vizualizing-the-data.html#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="vizualizing-the-data.html#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co"># build time-series plot</span></span>
<span id="cb31-17"><a href="vizualizing-the-data.html#cb31-17" aria-hidden="true" tabindex="-1"></a>lineplot <span class="ot">&lt;-</span> covid_data <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> new_cases_smoothed_per_million,</span>
<span id="cb31-18"><a href="vizualizing-the-data.html#cb31-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">group =</span> location, <span class="at">color =</span> location)) <span class="sc">+</span></span>
<span id="cb31-19"><a href="vizualizing-the-data.html#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb31-20"><a href="vizualizing-the-data.html#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> COLORS) <span class="sc">+</span></span>
<span id="cb31-21"><a href="vizualizing-the-data.html#cb31-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Smoothed New Cases</span><span class="sc">\n</span><span class="st"> per</span><span class="sc">\n</span><span class="st"> Million&#39;</span>,</span>
<span id="cb31-22"><a href="vizualizing-the-data.html#cb31-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour=</span><span class="st">&quot;Countries&quot;</span>) <span class="sc">+</span></span>
<span id="cb31-23"><a href="vizualizing-the-data.html#cb31-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">limits =</span> limits)</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="vizualizing-the-data.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_grid</span>(lineplot, time_line_plot,</span>
<span id="cb32-2"><a href="vizualizing-the-data.html#cb32-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">align=</span><span class="st">&#39;v&#39;</span>)</span></code></pre></div>
<p>After cleaning the data and building with it the plot. We retrieve a subplot
consisting of a time series of the smoothed new cases per million of COVID-19
for germany and sweden. In relation to that we plotted the corresponding policies
germany and sweden released in respect to restrictions and gatherings.</p>
<p>That said we want to go into how situations in germany and sweden changed and
how the countries reacted to those. Especially of interrest was the time before
the pandemic peak in germany in april. Both countries started on restricting
gatherings. Germany reduced the allowed gatherings of 1000 people, while sweden
was restricting it to 101-1000 people. After approximatly a week germany went into
a lockdown, while sweden reduced the number of allowed people in a gathering to
11-100. This policy sweden kept on until now. While in Germany during late summer
some attempts to lighten the policies on gatherings had been tried out. But those
have been overthrown with the increasing number of new cases.</p>
<p>This shows that Sweden chose way lighter policies with respect to gatherings
than germany even with way higher number of new cases.</p>
<p>So that we were asking ourself how this affected the narrative of the two countries
to each other. The idea was to compare the news reports of the countries over
each other.</p>
</div>
<div id="viz-2" class="section level2">
<h2>Viz 2</h2>
<p>Since the crisis-response seems to be different and we got the impression of the
use of sweden as a bad example in German media, we wanted to see, whether the
reporting in both countries about the respective other differed as well.
The first aspect we found interesting, was the amount of articles over time.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="vizualizing-the-data.html#cb33-1" aria-hidden="true" tabindex="-1"></a>sentiment_time_series <span class="ot">&lt;-</span></span>
<span id="cb33-2"><a href="vizualizing-the-data.html#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">read_rds</span>(<span class="st">&#39;./../data/documents_with_sentiments.rds&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="vizualizing-the-data.html#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">publish_date =</span> lubridate<span class="sc">::</span><span class="fu">as_date</span>(<span class="fu">as.Date</span>(publish_date))) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="vizualizing-the-data.html#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country, publish_date) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="vizualizing-the-data.html#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">number of articles</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb33-6"><a href="vizualizing-the-data.html#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-7"><a href="vizualizing-the-data.html#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb33-8"><a href="vizualizing-the-data.html#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_split</span>() <span class="sc">%&gt;%</span></span>
<span id="cb33-9"><a href="vizualizing-the-data.html#cb33-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(<span class="sc">~</span><span class="fu">mutate</span>(., <span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="dv">100</span> <span class="sc">*</span> . <span class="sc">/</span> <span class="fu">max</span>(.)))) <span class="sc">%&gt;%</span> </span>
<span id="cb33-10"><a href="vizualizing-the-data.html#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>( <span class="sc">~</span> <span class="fu">mutate</span>(., <span class="fu">across</span>(</span>
<span id="cb33-11"><a href="vizualizing-the-data.html#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">where</span>(is.numeric),</span>
<span id="cb33-12"><a href="vizualizing-the-data.html#cb33-12" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> stats<span class="sc">::</span><span class="fu">filter</span>(., <span class="at">filter =</span> <span class="fu">dnorm</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">7</span>)) <span class="sc">/</span></span>
<span id="cb33-13"><a href="vizualizing-the-data.html#cb33-13" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">sum</span>(<span class="fu">dnorm</span>(</span>
<span id="cb33-14"><a href="vizualizing-the-data.html#cb33-14" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">7</span>)</span>
<span id="cb33-15"><a href="vizualizing-the-data.html#cb33-15" aria-hidden="true" tabindex="-1"></a>                      ))),</span>
<span id="cb33-16"><a href="vizualizing-the-data.html#cb33-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">.names =</span> <span class="st">&#39;filter_{.col}&#39;</span></span>
<span id="cb33-17"><a href="vizualizing-the-data.html#cb33-17" aria-hidden="true" tabindex="-1"></a>  ))) <span class="sc">%&gt;%</span></span>
<span id="cb33-18"><a href="vizualizing-the-data.html#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&#39;original_number of articles&#39;</span> <span class="ot">=</span> <span class="st">&#39;number of articles&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-19"><a href="vizualizing-the-data.html#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb33-20"><a href="vizualizing-the-data.html#cb33-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">where</span>(is.numeric),</span>
<span id="cb33-21"><a href="vizualizing-the-data.html#cb33-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&#39;value&#39;</span>,</span>
<span id="cb33-22"><a href="vizualizing-the-data.html#cb33-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">&#39;quality&#39;</span>, <span class="st">&#39;indicator&#39;</span>),</span>
<span id="cb33-23"><a href="vizualizing-the-data.html#cb33-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">&#39;_&#39;</span></span>
<span id="cb33-24"><a href="vizualizing-the-data.html#cb33-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb33-25"><a href="vizualizing-the-data.html#cb33-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> quality,</span>
<span id="cb33-26"><a href="vizualizing-the-data.html#cb33-26" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> value)</span>
<span id="cb33-27"><a href="vizualizing-the-data.html#cb33-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-28"><a href="vizualizing-the-data.html#cb33-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-29"><a href="vizualizing-the-data.html#cb33-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-30"><a href="vizualizing-the-data.html#cb33-30" aria-hidden="true" tabindex="-1"></a>covid_data <span class="sc">%&lt;&gt;%</span> </span>
<span id="cb33-31"><a href="vizualizing-the-data.html#cb33-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(location) <span class="sc">%&gt;%</span> </span>
<span id="cb33-32"><a href="vizualizing-the-data.html#cb33-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_split</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb33-33"><a href="vizualizing-the-data.html#cb33-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(<span class="sc">~</span><span class="fu">mutate</span>(., <span class="at">cases =</span> <span class="dv">100</span> <span class="sc">*</span> new_cases_smoothed_per_million<span class="sc">/</span><span class="fu">max</span>(new_cases_smoothed_per_million)))</span>
<span id="cb33-34"><a href="vizualizing-the-data.html#cb33-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-35"><a href="vizualizing-the-data.html#cb33-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-36"><a href="vizualizing-the-data.html#cb33-36" aria-hidden="true" tabindex="-1"></a>article_timeseries_viz <span class="ot">&lt;-</span> </span>
<span id="cb33-37"><a href="vizualizing-the-data.html#cb33-37" aria-hidden="true" tabindex="-1"></a>  sentiment_time_series <span class="sc">%&gt;%</span> </span>
<span id="cb33-38"><a href="vizualizing-the-data.html#cb33-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> publish_date, <span class="at">y =</span> original)) <span class="sc">+</span></span>
<span id="cb33-39"><a href="vizualizing-the-data.html#cb33-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> scales<span class="sc">::</span><span class="fu">muted</span>(<span class="st">&#39;blue&#39;</span>), <span class="at">alpha =</span> .<span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb33-40"><a href="vizualizing-the-data.html#cb33-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> filter), <span class="at">color =</span> scales<span class="sc">::</span><span class="fu">muted</span>(<span class="st">&#39;blue&#39;</span>)) <span class="sc">+</span></span>
<span id="cb33-41"><a href="vizualizing-the-data.html#cb33-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(country),<span class="at">scales =</span> <span class="st">&#39;fixed&#39;</span>) <span class="sc">+</span></span>
<span id="cb33-42"><a href="vizualizing-the-data.html#cb33-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> covid_data, <span class="fu">aes</span>(<span class="at">y =</span> cases, <span class="at">x =</span> date, <span class="at">color =</span> location)) <span class="sc">+</span></span>
<span id="cb33-43"><a href="vizualizing-the-data.html#cb33-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> COLORS) <span class="sc">+</span></span>
<span id="cb33-44"><a href="vizualizing-the-data.html#cb33-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;bottom&#39;</span>) <span class="sc">+</span></span>
<span id="cb33-45"><a href="vizualizing-the-data.html#cb33-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Date of Publication&#39;</span>, </span>
<span id="cb33-46"><a href="vizualizing-the-data.html#cb33-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Number of Articles in % to Maximum&#39;</span>,</span>
<span id="cb33-47"><a href="vizualizing-the-data.html#cb33-47" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&#39;New Covid-19 cases:&#39;</span>) </span>
<span id="cb33-48"><a href="vizualizing-the-data.html#cb33-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-49"><a href="vizualizing-the-data.html#cb33-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-50"><a href="vizualizing-the-data.html#cb33-50" aria-hidden="true" tabindex="-1"></a>article_timeseries_viz</span></code></pre></div>
<p>By comparing these time-series with the infection-rates, one can recognize signs of a similarity in the number of German mentions of Sweden and Corona and the amount of cases in Sweden. Since the amount of articles seems to losely be coupled to the amount of cases in the respective other country, we will look at the content of these reports.</p>
</div>
<div id="der-plot-ist-noch-ein-bisschen-überladen.-was-ich-nicht-so-richtig-verstehe" class="section level2">
<h2>Der Plot ist noch ein bisschen überladen. Was ich nicht so richtig verstehe</h2>
</div>
<div id="viz-3" class="section level2">
<h2>Viz 3</h2>
<p>Let’s start by using the rather patchy sentiments we were able to gather to generate a few maps</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="vizualizing-the-data.html#cb34-1" aria-hidden="true" tabindex="-1"></a>sf_data <span class="ot">&lt;-</span> <span class="fu">get_eurostat_geospatial</span>(<span class="at">resolution =</span> <span class="st">&#39;10&#39;</span>,</span>
<span id="cb34-2"><a href="vizualizing-the-data.html#cb34-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nuts =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="vizualizing-the-data.html#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(CNTR_CODE <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SE&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="vizualizing-the-data.html#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="fu">get_eurostat_geospatial</span>(<span class="at">resolution =</span> <span class="st">&#39;10&#39;</span>,</span>
<span id="cb34-5"><a href="vizualizing-the-data.html#cb34-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">nuts =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="vizualizing-the-data.html#cb34-6" aria-hidden="true" tabindex="-1"></a>              <span class="fu">filter</span>(CNTR_CODE <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;DE&#39;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb34-7"><a href="vizualizing-the-data.html#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NAME_LATN =</span> <span class="fu">str_to_lower</span>(NAME_LATN))</span>
<span id="cb34-8"><a href="vizualizing-the-data.html#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="vizualizing-the-data.html#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="vizualizing-the-data.html#cb34-10" aria-hidden="true" tabindex="-1"></a>se_countrycodes <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">&#39;https://www.iso.org/obp/ui/#iso:code:3166:SE&#39;</span>)</span>
<span id="cb34-11"><a href="vizualizing-the-data.html#cb34-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-12"><a href="vizualizing-the-data.html#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="vizualizing-the-data.html#cb34-13" aria-hidden="true" tabindex="-1"></a>regional_sents <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">&#39;./../data/documents_with_sentiments.rds&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-14"><a href="vizualizing-the-data.html#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span> </span>
<span id="cb34-15"><a href="vizualizing-the-data.html#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_split</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb34-16"><a href="vizualizing-the-data.html#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(<span class="sc">~</span><span class="fu">group_by</span>(.,pub_state,country) <span class="sc">%&gt;%</span>  <span class="fu">summarise</span>(<span class="at">sentiment =</span> <span class="fu">mean</span>(m_sentiment)))</span></code></pre></div>
<p>Now we need to cross-reference the Mediacloud countrycodes (ISO 3166:SE, ISO 3166:DE) with the <code>eurostat</code> ones:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="vizualizing-the-data.html#cb35-1" aria-hidden="true" tabindex="-1"></a>iso_3166 <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(</span>
<span id="cb35-2"><a href="vizualizing-the-data.html#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&#39;Provinz;Code</span></span>
<span id="cb35-3"><a href="vizualizing-the-data.html#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="st">  Blekinge län;SE-K</span></span>
<span id="cb35-4"><a href="vizualizing-the-data.html#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="st">  Dalarnas län;SE-W</span></span>
<span id="cb35-5"><a href="vizualizing-the-data.html#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="st">  Gotlands län;SE-I</span></span>
<span id="cb35-6"><a href="vizualizing-the-data.html#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="st">  Gävleborgs län;SE-X</span></span>
<span id="cb35-7"><a href="vizualizing-the-data.html#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="st">  Hallands län;SE-N</span></span>
<span id="cb35-8"><a href="vizualizing-the-data.html#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="st">  Jämtlands län;SE-Z</span></span>
<span id="cb35-9"><a href="vizualizing-the-data.html#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="st">  Jönköpings län;SE-F</span></span>
<span id="cb35-10"><a href="vizualizing-the-data.html#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="st">  Kalmar län;SE-H</span></span>
<span id="cb35-11"><a href="vizualizing-the-data.html#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="st">  Kronobergs län;SE-G</span></span>
<span id="cb35-12"><a href="vizualizing-the-data.html#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="st">  Norrbottens län;SE-BD</span></span>
<span id="cb35-13"><a href="vizualizing-the-data.html#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="st">  Skåne län;SE-M</span></span>
<span id="cb35-14"><a href="vizualizing-the-data.html#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="st">  Stockholms län;SE-AB</span></span>
<span id="cb35-15"><a href="vizualizing-the-data.html#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="st">  Södermanlands län;SE-D</span></span>
<span id="cb35-16"><a href="vizualizing-the-data.html#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="st">  Uppsala län;SE-C</span></span>
<span id="cb35-17"><a href="vizualizing-the-data.html#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="st">  Värmlands län;SE-S</span></span>
<span id="cb35-18"><a href="vizualizing-the-data.html#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="st">  Västerbottens län;SE-AC</span></span>
<span id="cb35-19"><a href="vizualizing-the-data.html#cb35-19" aria-hidden="true" tabindex="-1"></a><span class="st">  Västernorrlands län;SE-Y</span></span>
<span id="cb35-20"><a href="vizualizing-the-data.html#cb35-20" aria-hidden="true" tabindex="-1"></a><span class="st">  Västmanlands län;SE-U</span></span>
<span id="cb35-21"><a href="vizualizing-the-data.html#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="st">  Västra Götalands län;SE-O</span></span>
<span id="cb35-22"><a href="vizualizing-the-data.html#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="st">  Örebro län;SE-T</span></span>
<span id="cb35-23"><a href="vizualizing-the-data.html#cb35-23" aria-hidden="true" tabindex="-1"></a><span class="st">  Östergötlands län;SE-E</span></span>
<span id="cb35-24"><a href="vizualizing-the-data.html#cb35-24" aria-hidden="true" tabindex="-1"></a><span class="st">  Baden-Württemberg;DE-BW</span></span>
<span id="cb35-25"><a href="vizualizing-the-data.html#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="st">  Bayern;DE-BY</span></span>
<span id="cb35-26"><a href="vizualizing-the-data.html#cb35-26" aria-hidden="true" tabindex="-1"></a><span class="st">  Berlin;DE-BE</span></span>
<span id="cb35-27"><a href="vizualizing-the-data.html#cb35-27" aria-hidden="true" tabindex="-1"></a><span class="st">  Brandenburg;DE-BB</span></span>
<span id="cb35-28"><a href="vizualizing-the-data.html#cb35-28" aria-hidden="true" tabindex="-1"></a><span class="st">  Bremen;DE-HB</span></span>
<span id="cb35-29"><a href="vizualizing-the-data.html#cb35-29" aria-hidden="true" tabindex="-1"></a><span class="st">  Hamburg;DE-HH</span></span>
<span id="cb35-30"><a href="vizualizing-the-data.html#cb35-30" aria-hidden="true" tabindex="-1"></a><span class="st">  Hessen;DE-HE</span></span>
<span id="cb35-31"><a href="vizualizing-the-data.html#cb35-31" aria-hidden="true" tabindex="-1"></a><span class="st">  Mecklenburg-Vorpommern;DE-MV</span></span>
<span id="cb35-32"><a href="vizualizing-the-data.html#cb35-32" aria-hidden="true" tabindex="-1"></a><span class="st">  Niedersachsen;DE-NI</span></span>
<span id="cb35-33"><a href="vizualizing-the-data.html#cb35-33" aria-hidden="true" tabindex="-1"></a><span class="st">  Nordrhein-Westfalen;DE-NW</span></span>
<span id="cb35-34"><a href="vizualizing-the-data.html#cb35-34" aria-hidden="true" tabindex="-1"></a><span class="st">  Rheinland-Pfalz;DE-RP</span></span>
<span id="cb35-35"><a href="vizualizing-the-data.html#cb35-35" aria-hidden="true" tabindex="-1"></a><span class="st">  Saarland;DE-SL</span></span>
<span id="cb35-36"><a href="vizualizing-the-data.html#cb35-36" aria-hidden="true" tabindex="-1"></a><span class="st">  Sachsen;DE-SN</span></span>
<span id="cb35-37"><a href="vizualizing-the-data.html#cb35-37" aria-hidden="true" tabindex="-1"></a><span class="st">  Sachsen-Anhalt;DE-ST</span></span>
<span id="cb35-38"><a href="vizualizing-the-data.html#cb35-38" aria-hidden="true" tabindex="-1"></a><span class="st">  Schleswig-Holstein;DE-SH</span></span>
<span id="cb35-39"><a href="vizualizing-the-data.html#cb35-39" aria-hidden="true" tabindex="-1"></a><span class="st">  Thüringen;DE-TH&#39;</span>,</span>
<span id="cb35-40"><a href="vizualizing-the-data.html#cb35-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">delim =</span> <span class="st">&#39;;&#39;</span></span>
<span id="cb35-41"><a href="vizualizing-the-data.html#cb35-41" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb35-42"><a href="vizualizing-the-data.html#cb35-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">str_trim</span>(.)))<span class="sc">%&gt;%</span> </span>
<span id="cb35-43"><a href="vizualizing-the-data.html#cb35-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Provinz =</span> <span class="fu">str_to_lower</span>(Provinz))</span>
<span id="cb35-44"><a href="vizualizing-the-data.html#cb35-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-45"><a href="vizualizing-the-data.html#cb35-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-46"><a href="vizualizing-the-data.html#cb35-46" aria-hidden="true" tabindex="-1"></a>regional_sents <span class="sc">%&lt;&gt;%</span></span>
<span id="cb35-47"><a href="vizualizing-the-data.html#cb35-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">right_join</span>(iso_3166, <span class="at">by =</span> <span class="fu">c</span>(<span class="at">pub_state =</span> <span class="st">&#39;Code&#39;</span>))</span></code></pre></div>
<p>This dataset can now be used to depict the overall regional sentiment in both countries:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="vizualizing-the-data.html#cb36-1" aria-hidden="true" tabindex="-1"></a>reg_sent_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(data,legend){</span>
<span id="cb36-2"><a href="vizualizing-the-data.html#cb36-2" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data) <span class="sc">+</span></span>
<span id="cb36-3"><a href="vizualizing-the-data.html#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">geometry =</span> geometry,<span class="at">fill =</span> sentiment), <span class="at">color =</span> <span class="st">&#39;grey&#39;</span>, <span class="at">expand =</span> F) <span class="sc">+</span></span>
<span id="cb36-4"><a href="vizualizing-the-data.html#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> scales<span class="sc">::</span><span class="fu">muted</span>(<span class="st">&#39;red&#39;</span>), </span>
<span id="cb36-5"><a href="vizualizing-the-data.html#cb36-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mid =</span> <span class="st">&#39;white&#39;</span>,</span>
<span id="cb36-6"><a href="vizualizing-the-data.html#cb36-6" aria-hidden="true" tabindex="-1"></a>                         <span class="at">high =</span> scales<span class="sc">::</span><span class="fu">muted</span>(<span class="st">&#39;blue&#39;</span>),</span>
<span id="cb36-7"><a href="vizualizing-the-data.html#cb36-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">na.value =</span> <span class="st">&#39;lightgrey&#39;</span>,</span>
<span id="cb36-8"><a href="vizualizing-the-data.html#cb36-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>))  <span class="sc">+</span></span>
<span id="cb36-9"><a href="vizualizing-the-data.html#cb36-9" aria-hidden="true" tabindex="-1"></a>    cowplot<span class="sc">::</span><span class="fu">theme_map</span>()</span>
<span id="cb36-10"><a href="vizualizing-the-data.html#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span>legend){</span>
<span id="cb36-11"><a href="vizualizing-the-data.html#cb36-11" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span>
<span id="cb36-12"><a href="vizualizing-the-data.html#cb36-12" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb36-13"><a href="vizualizing-the-data.html#cb36-13" aria-hidden="true" tabindex="-1"></a>      p <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">theme_void</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;right&#39;</span>)</span>
<span id="cb36-14"><a href="vizualizing-the-data.html#cb36-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb36-15"><a href="vizualizing-the-data.html#cb36-15" aria-hidden="true" tabindex="-1"></a>  p <span class="sc">+</span></span>
<span id="cb36-16"><a href="vizualizing-the-data.html#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="fu">st_crs</span>(<span class="st">&quot;+proj=merc&quot;</span>))</span>
<span id="cb36-17"><a href="vizualizing-the-data.html#cb36-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-18"><a href="vizualizing-the-data.html#cb36-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-19"><a href="vizualizing-the-data.html#cb36-19" aria-hidden="true" tabindex="-1"></a>plots <span class="ot">&lt;-</span> sf_data <span class="sc">%&gt;%</span> </span>
<span id="cb36-20"><a href="vizualizing-the-data.html#cb36-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(regional_sents[,<span class="fu">c</span>(<span class="st">&#39;Provinz&#39;</span>, <span class="st">&#39;sentiment&#39;</span>)],<span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;NAME_LATN&#39;</span> <span class="ot">=</span> <span class="st">&#39;Provinz&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-21"><a href="vizualizing-the-data.html#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(CNTR_CODE) <span class="sc">%&gt;%</span></span>
<span id="cb36-22"><a href="vizualizing-the-data.html#cb36-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_split</span>() <span class="sc">%&gt;%</span></span>
<span id="cb36-23"><a href="vizualizing-the-data.html#cb36-23" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span><span class="fu">reg_sent_plot</span>(.,<span class="at">legend =</span> F))</span>
<span id="cb36-24"><a href="vizualizing-the-data.html#cb36-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-25"><a href="vizualizing-the-data.html#cb36-25" aria-hidden="true" tabindex="-1"></a>legend <span class="ot">&lt;-</span> cowplot<span class="sc">::</span><span class="fu">get_legend</span>(<span class="fu">reg_sent_plot</span>(<span class="fu">mutate</span>(sf_data,<span class="at">sentiment =</span> <span class="dv">0</span>),<span class="at">legend =</span> T))</span>
<span id="cb36-26"><a href="vizualizing-the-data.html#cb36-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-27"><a href="vizualizing-the-data.html#cb36-27" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(</span>
<span id="cb36-28"><a href="vizualizing-the-data.html#cb36-28" aria-hidden="true" tabindex="-1"></a>  cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(<span class="at">plotlist =</span> plots),</span>
<span id="cb36-29"><a href="vizualizing-the-data.html#cb36-29" aria-hidden="true" tabindex="-1"></a>  legend,</span>
<span id="cb36-30"><a href="vizualizing-the-data.html#cb36-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">rel_widths =</span>  <span class="fu">c</span>(<span class="dv">4</span>,.<span class="dv">4</span>)</span>
<span id="cb36-31"><a href="vizualizing-the-data.html#cb36-31" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>And finally, let’s look at some wordclouds:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="vizualizing-the-data.html#cb37-1" aria-hidden="true" tabindex="-1"></a>wc_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">&#39;./../data/wordcloud_data.rds&#39;</span>)</span>
<span id="cb37-2"><a href="vizualizing-the-data.html#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="vizualizing-the-data.html#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="vizualizing-the-data.html#cb37-4" aria-hidden="true" tabindex="-1"></a>wordcloud <span class="ot">&lt;-</span> <span class="cf">function</span>(wc_data,country){</span>
<span id="cb37-5"><a href="vizualizing-the-data.html#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(ggwordcloud)</span>
<span id="cb37-6"><a href="vizualizing-the-data.html#cb37-6" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">get_eurostat_geospatial</span>(<span class="at">resolution =</span> <span class="st">&#39;10&#39;</span>,</span>
<span id="cb37-7"><a href="vizualizing-the-data.html#cb37-7" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">nuts =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-8"><a href="vizualizing-the-data.html#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(CNTR_CODE <span class="sc">%in%</span> <span class="fu">c</span>(country)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-9"><a href="vizualizing-the-data.html#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb37-10"><a href="vizualizing-the-data.html#cb37-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="at">fill =</span> <span class="st">&#39;black&#39;</span>, <span class="at">color =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb37-11"><a href="vizualizing-the-data.html#cb37-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_sf</span>(<span class="at">crs =</span> <span class="fu">st_crs</span>(<span class="st">&quot;+proj=moll&quot;</span>)) <span class="sc">+</span></span>
<span id="cb37-12"><a href="vizualizing-the-data.html#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>()</span>
<span id="cb37-13"><a href="vizualizing-the-data.html#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggsave</span>(<span class="st">&#39;temp.png&#39;</span>, <span class="at">plot =</span> p)</span>
<span id="cb37-14"><a href="vizualizing-the-data.html#cb37-14" aria-hidden="true" tabindex="-1"></a>  img <span class="ot">&lt;-</span> png<span class="sc">::</span><span class="fu">readPNG</span>(<span class="st">&#39;temp.png&#39;</span>)</span>
<span id="cb37-15"><a href="vizualizing-the-data.html#cb37-15" aria-hidden="true" tabindex="-1"></a>  dummy <span class="ot">&lt;-</span> <span class="fu">colSums</span>(img[,,<span class="dv">1</span>]) <span class="sc">!=</span> <span class="fu">max</span>(<span class="fu">colSums</span>(img[,,<span class="dv">1</span>]))</span>
<span id="cb37-16"><a href="vizualizing-the-data.html#cb37-16" aria-hidden="true" tabindex="-1"></a>  img <span class="ot">&lt;-</span> img[,dummy,]</span>
<span id="cb37-17"><a href="vizualizing-the-data.html#cb37-17" aria-hidden="true" tabindex="-1"></a>  dummy <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(img[,,<span class="dv">1</span>]) <span class="sc">!=</span> <span class="fu">max</span>(<span class="fu">rowSums</span>(img[,,<span class="dv">1</span>]))</span>
<span id="cb37-18"><a href="vizualizing-the-data.html#cb37-18" aria-hidden="true" tabindex="-1"></a>  img <span class="ot">&lt;-</span> img[dummy,,]</span>
<span id="cb37-19"><a href="vizualizing-the-data.html#cb37-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-20"><a href="vizualizing-the-data.html#cb37-20" aria-hidden="true" tabindex="-1"></a>  wc <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(wc_data,<span class="fu">aes</span>(<span class="at">label =</span> translation, <span class="at">size =</span> n, <span class="at">color =</span> sentiment)) <span class="sc">+</span> </span>
<span id="cb37-21"><a href="vizualizing-the-data.html#cb37-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text_wordcloud</span>(<span class="at">mask =</span> img,<span class="at">rm_outside =</span> T)<span class="sc">+</span></span>
<span id="cb37-22"><a href="vizualizing-the-data.html#cb37-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_gradient2</span>(<span class="at">low =</span> scales<span class="sc">::</span><span class="fu">muted</span>(<span class="st">&#39;red&#39;</span>), </span>
<span id="cb37-23"><a href="vizualizing-the-data.html#cb37-23" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mid =</span> <span class="st">&#39;grey&#39;</span>,</span>
<span id="cb37-24"><a href="vizualizing-the-data.html#cb37-24" aria-hidden="true" tabindex="-1"></a>                         <span class="at">high =</span> scales<span class="sc">::</span><span class="fu">muted</span>(<span class="st">&#39;blue&#39;</span>),</span>
<span id="cb37-25"><a href="vizualizing-the-data.html#cb37-25" aria-hidden="true" tabindex="-1"></a>                         <span class="at">na.value =</span> <span class="st">&#39;darkgrey&#39;</span>,</span>
<span id="cb37-26"><a href="vizualizing-the-data.html#cb37-26" aria-hidden="true" tabindex="-1"></a>                         <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>))</span>
<span id="cb37-27"><a href="vizualizing-the-data.html#cb37-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">file.remove</span>(<span class="st">&#39;temp.png&#39;</span>)</span>
<span id="cb37-28"><a href="vizualizing-the-data.html#cb37-28" aria-hidden="true" tabindex="-1"></a>  wc</span>
<span id="cb37-29"><a href="vizualizing-the-data.html#cb37-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-30"><a href="vizualizing-the-data.html#cb37-30" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb37-31"><a href="vizualizing-the-data.html#cb37-31" aria-hidden="true" tabindex="-1"></a>ger_wc <span class="ot">&lt;-</span> wc_data <span class="sc">%&gt;%</span> </span>
<span id="cb37-32"><a href="vizualizing-the-data.html#cb37-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&#39;Germany&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-33"><a href="vizualizing-the-data.html#cb37-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-34"><a href="vizualizing-the-data.html#cb37-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">500</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-35"><a href="vizualizing-the-data.html#cb37-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wordcloud</span>(<span class="at">country =</span> <span class="st">&#39;DE&#39;</span>)</span>
<span id="cb37-36"><a href="vizualizing-the-data.html#cb37-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-37"><a href="vizualizing-the-data.html#cb37-37" aria-hidden="true" tabindex="-1"></a>swe_wc <span class="ot">&lt;-</span> wc_data <span class="sc">%&gt;%</span> </span>
<span id="cb37-38"><a href="vizualizing-the-data.html#cb37-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">&#39;Sweden&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-39"><a href="vizualizing-the-data.html#cb37-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-40"><a href="vizualizing-the-data.html#cb37-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-41"><a href="vizualizing-the-data.html#cb37-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">wordcloud</span>(<span class="at">country =</span> <span class="st">&#39;SE&#39;</span>)</span>
<span id="cb37-42"><a href="vizualizing-the-data.html#cb37-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-43"><a href="vizualizing-the-data.html#cb37-43" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(ger_wc, swe_wc)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-acquisition.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": {},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
